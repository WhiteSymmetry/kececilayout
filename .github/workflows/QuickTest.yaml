name: Quick Test

on: workflow_dispatch

jobs:
  quick-test:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.11"

      - name: Create a clean environment and install dependencies
        run: |
          conda create -n test-env -y python=3.11
          conda install -n test-env -y \
            numpy \
            networkx \
            rustworkx \
            networkit \
            python-igraph \
            python-louvain \
            matplotlib-base \
            pycairo \
            cairocffi \
            cairo

      - name: Install the built package into the test environment
        run: |
          PACKAGE_FILE=$(ls dist/*.conda | head -n 1)
          echo "Installing $PACKAGE_FILE"
          conda install -n test-env -y "$PACKAGE_FILE"
          
      - name: Run final import test and get traceback
        run: |
          echo "--- Installing graphillion in test-env via pip ---"
          conda run -n test-env pip install "graphillion>=1.0"
          
          echo "--- Attempting to import kececilayout ---"
          conda run -n test-env python -c "import kececilayout"
          
      - name: Install and Test
        run: |
          pip install -e .
          python -c "
          import kececilayout as kl
          import networkx as nx
          
          # Basit test
          G = nx.complete_bipartite_graph(3, 3)
          pos = kl.kececi_layout(G)
          print('Keçeci layout çalışıyor!')
          print('Node positions:', pos)
          "
